<?xml version="1.0" encoding="utf-8"?>
<modification>
	<name>CMS</name>
	<code>OT_1.0</code>
	<version>1.0.0</version>
	<author>opencart.pro</author>
	<link>http://opencart.pro</link>
	<file path="catalog/view/theme/*/template/common/header.tpl">
		<operation error="skip">
		<search><![CDATA[<base href="<?php echo $base; ?>" />]]></search>
			<add position="before"><![CDATA[<?php if ($robots) { ?><meta name="robots" content="<?php echo $robots; ?>" /><?php } ?>
			]]></add>
		</operation>
	</file>
	<file path="catalog/view/theme/*/template/common/footer.tpl">
		<operation error="skip">
		<search><![CDATA[<li><a href="<?php echo $special; ?>"><?php echo $text_special; ?></a></li>]]></search>
			<add position="after"><![CDATA[<li><a href="<?php echo $mostviewed; ?>"><?php echo $text_mostviewed; ?></a></li><li><a href="<?php echo $bestseller; ?>"><?php echo $text_bestseller; ?></a></li><li><a href="<?php echo $latest; ?>"><?php echo $text_latest; ?></a></li>
			]]></add>
		</operation>
	</file>
	<file path="catalog/view/theme/*/template/product/product.tpl">
		<operation error="skip">
			<search index="0"><![CDATA[<?php echo $button_compare; ?>]]></search>
			<add position="after"><![CDATA[			<?php if ($pro_href_admin) { ?><button type="button" data-toggle="tooltip" class="btn btn-success" title="<?php echo $button_pro_href_admin; ?>" onclick="window.open('<?php echo $pro_href_admin; ?>', '_blank');"><i class="fa fa-pencil"></i></button><?php } ?>]]></add>
		</operation>
	</file>
	<file path="system/engine/loader.php">
		<operation error="skip">
			<search index="0"><![CDATA[function view($route, $data = array())]]></search>
			<add position="after"><![CDATA[		if (isset($this->registry->get('request')->get['route'])) {
			if (!isset($data['description'])) {
				$data['description'] = false;
			}
			if (!isset($data['description_bottom'])) {
				$data['description_bottom'] = false;
			}
			if ($route == $this->registry->get('request')->get['route'] || $route == 'common/footer') {
				$seomanager = $this->registry->get('db')->query("SELECT * FROM `" . DB_PREFIX . "pro_seo_tag` st LEFT JOIN `" . DB_PREFIX . "pro_seo_tag_to_store` stts ON (st.seo_tag_id = stts.seo_tag_id) WHERE st.status = '1' AND st.route = '" . $this->registry->get('db')->escape($this->registry->get('request')->get['route']) . "' AND stts.store_id = '" . (int)$this->registry->get('config')->get('config_store_id') . "'")->row;

				if ($seomanager) {
					$seomanager_desc = $this->registry->get('db')->query("SELECT * FROM `" . DB_PREFIX . "pro_seo_tag_description` WHERE seo_tag_id = '" . (int)$seomanager['seo_tag_id'] . "' AND language_id = '" . (int)$this->registry->get('config')->get('config_language_id') . "'")->row;

					if ($seomanager_desc['meta_h1']) {
						$data['heading_title'] = $seomanager_desc['meta_h1'];
					}
					if ($route == 'common/footer' && $seomanager_desc['meta_title']) {
						$this->registry->get('document')->setTitle($seomanager_desc['meta_title']);
					}
					if ($route == 'common/footer' && $seomanager_desc['meta_description']) {
						$this->registry->get('document')->setDescription($seomanager_desc['meta_description']);
					}
					if ($route == 'common/footer' && $seomanager_desc['meta_keyword']) {
						$this->registry->get('document')->setKeywords($seomanager_desc['meta_keyword']);
					}
					if ($seomanager_desc['description']) {
						$data['description'] = html_entity_decode($seomanager_desc['description'], ENT_QUOTES, 'UTF-8');
					}
					if ($seomanager_desc['description_bottom']) {
						$data['description_bottom'] = html_entity_decode($seomanager_desc['description_bottom'], ENT_QUOTES, 'UTF-8');
					}
				}
			}
		}]]></add>
		</operation>
	</file>
</modification>
